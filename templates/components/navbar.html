{% load role_tags %}
<nav class="bg-card shadow-sm w-screen">
    <div class="w-full flex justify-center border-b border-border sm:px-6 lg:px-8">
        <div class="w-full max-w-7xl flex flex-wrap items-center justify-between gap-4 py-3 px-4">
            <a href="/" class="flex items-center gap-3">
                {% load static %}
                <img src="{% static 'images/branding/logo-light.png' %}"
                     alt="dhet_app"
                     class="h-10 w-auto block dark:hidden">
                <img src="{% static 'images/branding/logo-dark.png' %}"
                     alt="dhet_app"
                     class="h-10 w-auto hidden dark:block">
            </a>
            <div class="flex flex-wrap items-center gap-2 text-xs text-muted-foreground sm:text-sm">
                <span class="flex items-center gap-1 rounded-full bg-muted/40 px-3 py-1">
                    <i data-lucide="at-sign" class="w-4 h-4"></i>
                    <span class="hidden sm:inline">{{ user.username }}</span>
                </span>
                {% if show_api_docs %}
                    <a href="/api/docs/"
                       target="_blank"
                       rel="noopener noreferrer"
                       class="flex items-center gap-1 rounded-lg px-3 py-1 text-primary transition hover:bg-primary/5">
                        <i data-lucide="book-open" class="w-4 h-4"></i>
                        <span class="hidden sm:inline">API</span>
                    </a>
                {% endif %}
                {# Super Admin Only #}
                {% if user.is_superuser or user|has_any_role:'super_admin' %}
                    <a href="/admin/"
                       target="_blank"
                       rel="noopener noreferrer"
                       class="flex items-center gap-1 rounded-lg px-3 py-1 text-primary transition hover:bg-primary/5">
                        <i data-lucide="shield" class="w-4 h-4"></i>
                        <span class="hidden sm:inline">Admin</span>
                    </a>
                {% endif %}
                <form method="post"
                      action="{% url 'account_logout' %}"
                      class="inline-flex items-center">
                    {% csrf_token %}
                    <button type="submit"
                            class="flex items-center gap-1 rounded-lg px-3 py-1 text-primary transition hover:bg-primary/20">
                        <i data-lucide="power" class="w-4 h-4"></i>
                        <span class="hidden sm:inline">Logout</span>
                    </button>
                </form>
            </div>
        </div>
    </div>
    {% if not show_onboarding %}
        {% with current=request.resolver_match.url_name %}
            <div class="w-full flex justify-center">
                <div class="w-full max-w-7xl flex flex-wrap gap-6 px-4">
                    {# Dashboard - visible to all authenticated users #}
                    {# Dashboard - visible to all authenticated users EXCEPT admins #}
                    {% if user.candidate %}
                        <a href="/dashboard"
                           class="relative flex items-center gap-2 py-4 text-sm font-medium transition-colors {% if current and 'dashboard' in current %}text-primary after:absolute after:bottom-0 after:left-0 after:h-0.5 after:w-full after:bg-primary{% else %}text-muted-foreground hover:text-primary{% endif %}"
                           aria-current="{% if current and 'dashboard' in current %}page{% endif %}">
                            <i data-lucide="layout-dashboard" class="w-4 h-4"></i>
                            <span class="">Dashboard</span>
                        </a>
                    {% endif %}
                    {# Occupations - visible to candidates and content managers #}
                    {% if user.candidate or user|has_any_role:'content_manager,admin' or user.is_superuser %}
                        <a href="{% url 'occupations' %}"
                           class="relative flex items-center gap-2 py-4 text-sm font-medium transition-colors {% if current and 'occupation' in current and current != 'occupation-assessment' %}text-primary after:absolute after:bottom-0 after:left-0 after:h-0.5 after:w-full after:bg-primary{% else %}text-muted-foreground hover:text-primary{% endif %}"
                           aria-current="{% if current and 'occupation' in current and current != 'occupation-assessment' %}page{% endif %}">
                            <i data-lucide="briefcase" class="w-4 h-4"></i>
                            <span class="">Occupations</span>
                        </a>
                    {% endif %}
                    {# Users - visible to superadmin, admin, developer #}
                    {% if user|has_any_role:'super_admin,admin,developer' or user.is_superuser %}
                        <a href="{% url 'user_list' %}"
                           class="relative flex items-center gap-2 py-4 text-sm font-medium transition-colors {% if current and 'user_' in current %}text-primary after:absolute after:bottom-0 after:left-0 after:h-0.5 after:w-full after:bg-primary{% else %}text-muted-foreground hover:text-primary{% endif %}"
                           aria-current="{% if current and 'user_' in current %}page{% endif %}">
                            <i data-lucide="users" class="w-4 h-4"></i>
                            <span class="">Users</span>
                        </a>
                    {% endif %}
                    {# Assessments - visible to candidates only #}
                    {% if role == 'user' %}
                        <a href="{% url 'candidates:assessment-list' %}"
                           class="relative flex items-center gap-2 py-4 text-sm font-medium transition-colors {% if current and 'assessment' in current %}text-primary after:absolute after:bottom-0 after:left-0 after:h-0.5 after:w-full after:bg-primary{% else %}text-muted-foreground hover:text-primary{% endif %}"
                           aria-current="{% if current and 'assessment' in current %}page{% endif %}">
                            <i data-lucide="clipboard-list" class="w-4 h-4"></i>
                            <span class="">Assessments</span>
                        </a>
                    {% endif %}
                    {# Profile - visible to all authenticated users #}
                    <a href="{{ profile_url }}"
                       class="relative flex items-center gap-2 py-4 text-sm font-medium transition-colors {% if current and 'profile' in current %}text-primary after:absolute after:bottom-0 after:left-0 after:h-0.5 after:w-full after:bg-primary{% else %}text-muted-foreground hover:text-primary{% endif %}"
                       aria-current="{% if current and 'profile' in current %}page{% endif %}">
                        <i data-lucide="user" class="w-4 h-4"></i>
                        <span class="">Profile</span>
                    </a>
                </div>
            </div>
        {% endwith %}
    {% endif %}
</div>
</nav>
