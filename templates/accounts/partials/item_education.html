<div x-data="{ editing: false }" class="item-container p-4 rounded-lg border border-border bg-card transition" :class="{ 'hover:bg-accent/50': !editing }">
    <!-- View Mode -->
    <div x-show="!editing">
        <div class="flex items-start justify-between gap-4">
            <div>
                <h4 class="font-semibold text-foreground">{{ edu.institution }}</h4>
                <div class="text-sm text-foreground/80 mt-1">
                    {{ edu.get_education_type_display }}
                    {% if edu.field_of_study %}
                        - {{ edu.field_of_study }}
                    {% endif %}
                </div>
                <div class="flex items-center gap-2 mt-2 text-xs text-muted-foreground">
                    <i data-lucide="calendar" class="w-3 h-3"></i>
                    <span>Completed {{ edu.year_completed }}</span>
                </div>
            </div>
            <div class="flex items-center gap-2">
                 <button type="button" @click="editing = true" class="p-2 rounded-full hover:bg-muted text-muted-foreground hover:text-primary transition">
                    <i data-lucide="pencil" class="w-4 h-4"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Mode -->
    <div x-show="editing" style="display: none;">
        <form method="post"
              action="{% url 'profile-education-detail' pk=edu.pk %}"
              hx-post="{% url 'profile-education-detail' pk=edu.pk %}"
              hx-target="closest .item-container"
              hx-swap="outerHTML"
              x-data="{ isSubmitting: false, educationType: '{{ edu.education_type }}' }"
              @submit="isSubmitting = true">
              
            <div class="space-y-4 mb-4">
               <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        {% include "components/select.html" with name="education_type" label="Education Type" options=form.education_type.field.choices value=edu.education_type use_tuple=True x_model="educationType" placeholder="Select type" %}
                    </div>
                     <div>
                        <label class="block mb-2 text-sm font-medium text-muted-foreground">Year Completed</label>
                        <input type="number" name="year_completed" value="{{ edu.year_completed }}" class="app-input" required>
                    </div>
                </div>
                <div>
                    <label class="block mb-2 text-sm font-medium text-muted-foreground">Institution</label>
                    <input type="text" name="institution" value="{{ edu.institution }}" class="app-input" required>
                </div>
                <div x-show="educationType !== 'MATRIC'">
                     <label class="block mb-2 text-sm font-medium text-muted-foreground">Qualification Name / Field of Study</label>
                    <input type="text" name="field_of_study" value="{{ edu.field_of_study }}" class="app-input" :required="educationType !== 'MATRIC'">
                </div>
            </div>

            <div class="flex items-center justify-between">
                <button type="button" 
                        hx-delete="{% url 'profile-education-detail' pk=edu.pk %}" 
                        hx-target="closest .item-container" 
                        hx-confirm="Are you sure you want to delete this qualification?"
                        class="app-btn app-btn-ghost text-destructive hover:bg-destructive/10">
                    Delete
                </button>
                <div class="flex items-center gap-2">
                    <button type="button" @click="editing = false" class="app-btn app-btn-ghost">Cancel</button>
                    <button type="submit" class="app-btn app-btn-primary" :disabled="isSubmitting">
                         <span x-show="!isSubmitting">Save</span>
                        <span x-show="isSubmitting">Saving...</span>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
